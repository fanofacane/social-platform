<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
        PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
        "https://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.example.in_sky1.mapper.ChatMapper">
    <!--根据ID更新员工基本信息-->
    <!--set标签: 会自动生成set关键字; 会自动的删除掉更新字段后多余,-->


    <select id="getFollowingIdList" resultType="Integer">
        SELECT uf.following_id
        FROM user_follow uf left join users u  on u.id=uf.follower_id
        WHERE  u.id= #{userId}
    </select>

    <select id="getChatUserList" resultType="com.example.in_sky1.dto.ChatUserVO">
        SELECT * FROM users
        WHERE id IN
        <foreach item="id" collection="ids" open="(" separator="," close=")">
            #{id}
        </foreach>
    </select>

    <select id="getChatHistoryIds" resultType="Integer">
        SELECT DISTINCT `from`
        FROM chat_messages
        WHERE `to` = #{userId}
        UNION
        SELECT DISTINCT `to`
        FROM chat_messages
        WHERE `from` = #{userId};
    </select>
</mapper>